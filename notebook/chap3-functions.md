## 3. 함수를 잘 만드는 법



### 3.1 작게, 더 작게
- 가로 150자, 100줄을 넘어서는 안된다. 아니, 20줄도 길다.
- 블록과 들여쓰기 : `if / else / while`문 안에 들어가는 블록은 한 줄이어야 한다.
    - 거기 안에서 함수를 호출한다.
    - 중첩 구조가 생길만큼 함수가 커져서는 안된다.
    - 함수의 들여쓰기 수준은 **1단이나 2단**을 넘어가면 안 된다.
    
    
### 3.2 한 가지만 해라!
- 함수는 한가지를 해야한다. 그 한가지를 잘해야한다. 그 한가지만을 해야한다.
- 우리가 함수를 만드는 이유 : 큰 개념을 다음 추상화 수준에서 여러 단계로 나눠 수행하기 위해서
- 함수가 '한 가지'만 하는지 판단하는 방법
    - 의미 있는 이름으로 다른 함수를 추출할 수 있다면 그 함수는 여러 작업을 하는거다.
    - 자연스럽게 섹션으로 나누기 어렵다.

### 3.3 함수 당 추상화 수준은 하나로!
- 함수가 확실히 '한 가지' 작업만 하려면 함수 내 모든 문장의 **추상화 수준**이 동일해야 한다.
- 한 함수 내에 추상화 수준을 섞으면 코드를 읽는 사람이 헷갈린다. 특정 표현이 근본 개념인지 세부사항인지 구분하기 어렵기 때문.
- 내려가기 규칙 : 위에서 아래로 코드 읽기
    - 코드는 위애서 아래로 이야기처럼 읽혀야 한다.
    - 한 함수 다음에는 추상화 수준이 한 단계 낮은 함수가 온다.
    
### 3.4 Switch 문 
- Switch문은 본질적으로 N가지를 처리한다.
- 예시 Switch문이 가지는 문제들
    - 1) 함수가 길어진다.
    - 2) '한 가지' 작업만 수행하지 않는다. 
    - 3) SRP(single responsibility principle, 객체 지향 프로그래밍에서 단일 책임 원칙이란 모든 클래스는 하나의 책임만 가지며, 클래스는 그 책임을 완전히 캡슐화해야 함을 일컫는다.)를 위반한다.
    - 4) OCP(개방-폐쇄 원칙, Open-Closed Principle, 소프트웨어 개체(클래스, 모듈, 함수 등등)는 확장에 대해 열려 있어야 하고, 수정에 대해서는 닫혀 있어야 한다'는 프로그래밍 원칙이다.)를 위반한다. 
    
- switch문을 저차원 클래스에 숨기고 절대로 반복하지 않는 방법은 있다. 다형성을 이용한다.

### 3.5 서술적인 이름을 사용해라!

> 길고 서술적인 이름이 짧고 어려운 이름보다 좋고, 길고 서술적인 주석보다 좋다.

- testableHtml -> SetupTeardownIncluder, render
- 서술적인 이름을 사용하면 개발자 머릿속에서도 설계가 뚜렷해지므로 코드를 개선하기 쉬워진다.

### 3.6 함수 parameter

- 가장 이상적인 parameter는 0개(무항)이다. 다음은 1개, 다음은 2개, 3개부터는 가능한 피하는 편이 좋다. 
- parameter는 개념을 이해하기 어렵게 만든다. 코드를 읽는 사람이 parameter를 발견할 때마다 의미를 해석해야 한다.
- 테스트 관점에서 봐도 갖가지 parameter 조합으로 함수를 검증하는 테스트 케이스를 작성하는것은 복잡하다.
- 출력 인수는 입력 인수보다 이해하기 어렵다.
- 많이 쓰는 단항 형식
    - 인수에 질문을 던지는 경우
        - ex. boolean fileExists("MyFile"), InputStream fileOpen("MyFile")
    - 이벤트 : 입력 인수만 있음, 이벤트라는 사실이 코드에 명확히 드러나게 사용해야 함
        - ex. passwordAttemptFailedNtimes(int attempts)
    - 위 두가지 경우가 아니라면 단항 함수는 가급적 피한다.
        - 변화 함수에서 출력 인수를 사용하지 말고, 변환 결과는 반환값으로 돌려줘라.
- 플래그 인수 : 끔찍하니 쓰지마라
- 이항 함수 : 한 값을 표현하거나, 자연적인 순서가 있는 경우가 아니라면 가급적 함수 인수는 하나만 써라.
- 삼항 함수 : 인수가 3개인 함수는 인수가 2개인 함수보다 이해하기 어렵다. 순서, 인식시간, 무시로 야기되는 문제가 두 배 이상 늘어난다.
- 인수 객체 : 인수가 2~3개 필요하다면 독자적인 클래스 변수로 선언해보자.
- 인수 목록 : 인수 개수가 가변적인 함수(... args)
    - ex. public String format(String format, Object... args)
- 동사와 키워드 : 함수 이름에 키워드(인수 이름)을 넣는것이 좋다.
    - ex. assertEquals() < assertExpectedEqualsActual(expected, actual)

### 3.7 부수 효과를 일으키지 마라
- 한 가지를 하겠다고 약속해놓고 다른 일을 하지 마라.
- ex. checkPassword() 안에서 initialize()하기
- 만약 시간적인 결합이 필요하다면 함수 이름에 분명히 명시하라.
- 출력 인수 쓰지 말고 함수가 속한 객체 상태를 변경하는 방식을 택하라.

### 3.8 명령과 조회를 분리하라.
- 함수는 뭔가를 수행(명령)하거나, 뭔가에 답하거나(조회) 둘 중하나만 해야한다.

### 3.9 오류 코드보다 예외를 사용하라!
- 명령 함수에서 오류 코드를 반환하는 방식은 명령/조회 분리 규칙을 위반한다.
- try/catch 블록도 별도 함수로 뽑아내는것이 좋다.
- 오류 처리도 '한 가지 작업'에 속한다. 오류 처리하는 함수는 오류만 처리해야 마땅하다.

### 3.10 반복하지 마라(Don't Repeat Youself, DRY)
- 코드 길이가 늘어날 뿐 아니라 알고리즘이 변하면 모두 손봐야 한다.

### 3.11 구조적 프로그래밍
- 다익스트라 : 모든 함수와 함수 내 모든 블록에 entry와 exit이 하나만 존재해야 한다. 루프 안에서는 break나 continue를 사용해선 안 되며, goto는 절대 안된다.
    - 함수가 작다면 별 이익을 제공하지 못함.
- 함수를 작게 만든다면 return, break, continue를 여러 차례 사용해도 괜찮다. 의도를 표현하기 쉬워지기도 한다. goto는 피해라.


### 3.12 함수를 어떻게 짜죠?
- 글짓기처럼, 처음에는 길고 복잡해도 계속 다듬어가며 최종적으로는 이 장에서 설명한 규칙들을 따라는 함수가 얻어진다. 
- 처음부터 탁 짜내지 않는다! 

### 3.13 결론
- 프로그래밍의 기술은 언어 설계의 기술이다.
- 목표는 시스템이라는 이야기를 풀어가는데 있다는 사실을 기억하길~
- **작성하는 함수가 분명하고 정확한 언어로 깔끔하게 맞아떨어져야 이야기를 풀어가기가 쉬워진다.**
